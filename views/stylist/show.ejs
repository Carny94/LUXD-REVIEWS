<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="/stylesheets/show.css"> 

</head>
<body>
  </html>
  <%- include('../partials/header') %>

  <div id="show-page-container">
    <section id="show-page">
      <div class="show-info-label">INSTAGRAM:</div>
      <div class="show-info-value"><%= stylist.instagram %></div>
      <div class="show-info-label">ARTISTRY TYPE:</div>
      <div class="show-info-value"><%= stylist.artistryType %></div>
      <div class="show-info-label">WILL YOU REFER ?:</div>
      <div class="show-info-value"><%= stylist.recommended ? 'YES' : 'NO' %></div>
    </section>

    <form action="/stylist/<%= stylist._id %>?_method=DELETE" class="delete-form" method="POST">
      <button type="submit">Delete Submission</button>
    </form>

    <br><br>
    <h2 class="review-header">Reviews</h2>
    <% if (user) { %>
      <form id="add-review-form" method="post" action="/stylist/<%= stylist._id %>/reviews">
        <label for="review-content">Review:</label>
        <textarea name="content" id="review-content"></textarea>
        <label for="star-rating">Rating:</label>
        <fieldset class="star-rating">
          <input type="radio" id="star5" name="rating" value="5" />
          <label for="star5">5 stars</label>
          <input type="radio" id="star4" name="rating" value="4" />
          <label for="star4">4 stars</label>
          <input type="radio" id="star3" name="rating" value="3" />
          <label for="star3">3 stars</label>
          <input type="radio" id="star2" name="rating" value="2" />
          <label for="star2">2 stars</label>
          <input type="radio" id="star1" name="rating" value="1" />
          <label for="star1">1 star</label>
        </fieldset>
        <input type="submit" value="Add Review">
      </form>
    <% } %>

    <% if (stylist.reviews.length) { %>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Review</th>
            <th>Rating</th>
          </tr>
        </thead>
        <tbody>
          <% stylist.reviews.forEach(function(r) { %>
            <tr>
              <td><%= r.createdAt.toLocaleDateString() %></td>
              <td><%= r.content %></td>
              <td><%= r.rating %></td>
            </tr>
          <% }); %>
        </tbody>
        <tbody>
          <% let total = 0 %>
          <% stylist.reviews.forEach(function(r) { %>
            <% total += r.rating %>
            <tr>
              <td class="review-user">
                <img alt="avatar" src="<%= r.userAvatar %>" referrerpolicy="no-referrer">
                <%= r.userName %>
              </td>
              <td><%= r.createdAt.toLocaleDateString() %></td>
              <td><%= r.content %></td>
              <td><%= r.rating %></td>
            </tr>
          <% }); %>
          <tr>
            <td colspan="2"></td>
            <td><strong><%= (total / stylist.reviews.length).toFixed(1) %></strong></td>
          </tr>
        </tbody>
      </table>
      <a href="/stylist/<%= stylist.id %>/edit">EDIT</a>
    <% } else { %>
      <h5>No Reviews Yet</h5>
    <% } %>
  </div>
</body>

</html>
